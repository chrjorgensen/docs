---
title: API
sidebar:
    order: 3
---

import { Aside, Icon } from '@astrojs/starlight/components';

It is possible to write VS Code extensions that are based on Code for IBM i. That means your extension can use the connection that the user creates in your extension. This is not an extension tutorial, but an intro on how to access the APIs available within Code for IBM i.

For example, you might be a vendor that produces lists or HTML that you'd like to be accessible from within Visual Studio Code.

# Exports

As well as the basic VS Code command API, you can get access to the Code for IBM i API with the VS Code `getExtension` API.

```ts
const { instance } = vscode.extensions.getExtension(`halcyontechltd.code-for-ibmi`).exports;
```

## Typings

We provide TS type definitions to make using the Code for IBM i API easier. They can be installed via `npm`:

```bash title="terminal"
npm i @halcyontech/vscode-ibmi-types
```

It can then be imported and used in combination with `getExtension`:

```ts
import type { CodeForIBMi } from '@halcyontech/vscode-ibmi-types';

//...

const ext = vscode.extensions.getExtension<CodeForIBMi>('halcyontechltd.code-for-ibmi');
```

<Aside type="danger"> 
  As Code for IBM i updates, the API may change. It is recommended you always keep the types packaged updated as the extension updates, incase the API interfaces change. We plan to make the VS Code command API interfaces stable so they will not break as often after they have been released.
</Aside>

## Example import

This example can be used as a simple way to access the Code for IBM i instance.

```ts
import { CodeForIBMi } from "@halcyontech/vscode-ibmi-types";
import Instance from "@halcyontech/vscode-ibmi-types/api/Instance";
import { Extension, extensions } from "vscode";

let baseExtension: Extension<CodeForIBMi>|undefined;

/**
 * This should be used on your extension activation.
 */
export function loadBase(): CodeForIBMi|undefined {
  if (!baseExtension) {
    baseExtension = (extensions ? extensions.getExtension(`halcyontechltd.code-for-ibmi`) : undefined);
  }
  
  return (baseExtension && baseExtension.isActive && baseExtension.exports ? baseExtension.exports : undefined);
}

/**
 * Used when you want to fetch the extension 'instance' (the connection)
 */
export function getInstance(): Instance|undefined {
  return (baseExtension && baseExtension.isActive && baseExtension.exports ? baseExtension.exports.instance : undefined);
}
```


## CustomUI.d.ts
### Section

#### Properties

- `fields: Field[]`

#### Methods

- `addHeading(label: string, level: 1 | 2 | 3 | 4 | 5 | 6): this`
- `addHorizontalRule(): this`
- `addCheckbox(id: string, label: string, description: string, checked: boolean): this`
- `addInput(id: string, label: string, description: string, options: {
        default?: string;
        readonly?: boolean;
        rows?: number;
        minlength?: number;
        maxlength?: number;
        regexTest?: string;
    }): this`
- `addParagraph(label: string): this`
- `addFile(id: string, label: string, description: string): this`
- `addPassword(id: string, label: string, description: string, defaultValue: string): this`
- `addTabs(tabs: Tab[], selected: number): this`
- `addComplexTabs(tabs: ComplexTab[], selected: number): this`
- `addSelect(id: string, label: string, items: SelectItem[], description: string): this`
- `addTree(id: string, label: string, treeItems: TreeListItem[], description: string): this`
- `addButtons(buttons: (Button | undefined)[]): this`
- `addField(field: Field): this`

### CustomUI

#### Methods

- `loadPage(title: string, callback: (page: Page<T>) => void): Promise<Page<T>> | undefined`
- `setOptions(options: PanelOptions): this`

### Field

#### Constructor

- `Field(type: FieldType, id: string, label: string, description: string): Field`

#### Properties

- `type: FieldType`
- `id: string`
- `label: string`
- `description?: string`
- `items?: FieldItem[]`
- `treeList?: TreeListItem[]`
- `complexTabItems?: ComplexTab[]`
- `default?: string`
- `readonly?: boolean`
- `rows?: number`
- `minlength?: number`
- `maxlength?: number`
- `regexTest?: string`

#### Methods

- `getHTML(): string`

### Page

#### Properties

- `panel: vscode.WebviewPanel`
- `data?: T`

### Button

#### Properties

- `id: string`
- `label: string`
- `requiresValidation?: boolean`

### SelectItem

#### Properties

- `text: string`
- `description: string`
- `value: string`
- `selected?: boolean`

### Tab

#### Properties

- `label: string`
- `value: string`

### ComplexTab

#### Properties

- `label: string`
- `fields: Field[]`

### TreeListItemIcon

#### Properties

- `branch?: string`
- `open?: string`
- `leaf?: string`

### TreeListItem

#### Properties

- `label: string`
- `subItems?: TreeListItem[]`
- `open?: boolean`
- `selected?: boolean`
- `focused?: boolean`
- `icons?: TreeListItemIcon`
- `value?: string`
- `path?: number[]`

### FieldItem

#### Properties

- `label?: string`
- `value?: string`
- `selected?: boolean`
- `description?: string`
- `text?: string`
- `id?: string`

## Configuration.d.ts
### StoredConnection

#### Properties

- `index: number`
- `data: ConnectionData`

## Filter.d.ts
## typings.d.ts
### BrowserItem

#### Constructor

- `BrowserItem(label: string, params: BrowserItemParameters): BrowserItem`

#### Properties

- `params?: BrowserItemParameters`

#### Methods

- `getChildren(): ProviderResult<BrowserItem[]>`
- `refresh(): void`
- `reveal(options: FocusOptions): Thenable<void>`
- `getToolTip(): Promise<MarkdownString | undefined>`

### CodeForIBMi

#### Properties

- `instance: Instance`
- `customUI: () => CustomUI`
- `deployTools: typeof DeployTools`
- `evfeventParser: (lines: string[]) => Map<string, FileError[]>`
- `tools: typeof Tools`
- `componentRegistry: ComponentRegistry`

### DeploymentParameters

#### Properties

- `method: DeploymentMethod`
- `workspaceFolder: WorkspaceFolder`
- `remotePath: string`
- `ignoreRules?: Ignore`

### StandardIO

#### Properties

- `onStdout?: (data: Buffer) => void`
- `onStderr?: (data: Buffer) => void`
- `stdin?: string`

### RemoteCommand

#### Properties

- `title?: string`
- `command: string`
- `environment?: ActionEnvironment`
- `cwd?: string`
- `env?: Record<string, string>`
- `noLibList?: boolean`

### CommandData

#### Properties

- `command: string`
- `directory?: string`
- `env?: Record<string, string>`

### CommandResult

#### Properties

- `code: number`
- `stdout: string`
- `stderr: string`
- `command?: string`

### Action

#### Properties

- `name: string`
- `command: string`
- `type?: ActionType`
- `environment: ActionEnvironment`
- `extensions?: string[]`
- `deployFirst?: boolean`
- `postDownload?: string[]`
- `refresh?: ActionRefresh`
- `runOnProtected?: boolean`

### ConnectionData

#### Properties

- `name: string`
- `host: string`
- `port: number`
- `username: string`
- `password?: string`
- `privateKey?: string`
- `privateKeyPath?: string`
- `keepaliveInterval?: number`

### Server

#### Properties

- `name: string`

### Profile

#### Properties

- `profile: string`

### QsysPath

#### Properties

- `asp?: string`
- `library: string`
- `name: string`

### IBMiObject

#### Properties

- `type: string`
- `text: string`
- `sourceFile?: boolean`
- `attribute?: string`
- `sourceLength?: number`
- `size?: number`
- `created?: Date`
- `changed?: Date`
- `created_by?: string`
- `owner?: string`

### IBMiMember

#### Properties

- `library: string`
- `file: string`
- `name: string`
- `extension: string`
- `recordLength?: number`
- `text?: string`
- `asp?: string`
- `lines?: number`
- `created?: Date`
- `changed?: Date`

### IFSFile

#### Properties

- `type: "directory" | "streamfile"`
- `name: string`
- `path: string`
- `size?: number`
- `modified?: Date`
- `owner?: string`

### IBMiError

#### Properties

- `code: string`
- `text: string`

### FileError

#### Properties

- `sev: number`
- `lineNum: number`
- `toLineNum: number`
- `column: number`
- `toColumn: number`
- `text: string`
- `code: string`

### QsysFsOptions

#### Properties

- `readonly?: boolean`

### WithPath

#### Properties

- `path: string`

### WithLibrary

#### Properties

- `library: string`

### FilteredItem

#### Properties

- `filter: ConnectionConfiguration.ObjectFilters`

### ObjectItem

#### Properties

- `object: IBMiObject`

### MemberItem

#### Properties

- `member: IBMiMember`

### WrapResult

#### Properties

- `newStatements: string[]`
- `outStmf: string`

